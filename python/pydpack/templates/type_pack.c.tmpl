## static int
## struct_pack_name(struct dpack_encoder *encoder, const void *data)
#from pydpack.util import todef
$(assert)(encoder);
$(assert)(data);

#if $status == 'obsolete'
#if $mandatory
#set $p = " " * (len($encode) + 7)
int err;

err = $(encode)(encoder,
$(p)$field,
$(p)$obsolete_value);
if (err)
	return err;

return 0;
#else
return 0;
#end if
#else
const struct $struct_type *obj = (struct $(struct_type) *)data;
int err;

if (!$(struct_type)_has_$(name)(data))
	return 0;

#set $p = " " * (len($encode) + 7)
err = $(encode)(encoder,
$(p)$field,
$(p)obj->$name);
if (err)
	return err;

return 0;
#end if